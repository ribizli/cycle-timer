var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}function l(t){let e;return o(t,t=>e=t)(),e}function c(t,e,n){t.$$.on_destroy.push(o(e,n))}function a(t,e,n=e){return t.set(n),e}function u(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function p(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function h(){return m(" ")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function $(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}let w,k;function x(){if(void 0===w){w=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){w=!0}}return w}function S(t,e,n){t.classList[n?"add":"remove"](e)}function L(t){k=t}const E=[],_=[],A=[],M=[],O=Promise.resolve();let T=!1;function I(t){A.push(t)}let N=!1;const C=new Set;function W(){if(!N){N=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];L(e),j(e.$$)}for(L(null),E.length=0;_.length;)_.pop()();for(let t=0;t<A.length;t+=1){const e=A[t];C.has(e)||(C.add(e),e())}A.length=0}while(E.length);for(;M.length;)M.pop()();T=!1,N=!1,C.clear()}}function j(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const z=new Set;function H(t,e){t&&t.i&&(z.delete(t),t.i(e))}function q(t,e){t.d(1),e.delete(t.key)}function B(t,n,r){const{fragment:o,on_mount:l,on_destroy:c,after_update:a}=t.$$;o&&o.m(n,r),I(()=>{const n=l.map(e).filter(i);c?c.push(...n):s(n),t.$$.on_mount=[]}),a.forEach(I)}function J(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function P(t,e){-1===t.$$.dirty[0]&&(E.push(t),T||(T=!0,O.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(e,i,r,o,l,c,a=[-1]){const u=k;L(e);const f=i.props||{},p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let m=!1;if(p.ctx=r?r(e,f,(t,n,...s)=>{const i=s.length?s[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),m&&P(e,t)),n}):[],p.update(),m=!0,s(p.before_update),p.fragment=!!o&&o(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();i.intro&&H(e.$$.fragment),B(e,i.target,i.anchor),W()}L(u)}class D{$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const V=[];function F(e,n=t){let s;const i=[];function o(t){if(r(e,t)&&(e=t,s)){const t=!V.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(r,l=t){const c=[r,l];return i.push(c),1===i.length&&(s=n(o)||t),r(e),()=>{const t=i.indexOf(c);-1!==t&&i.splice(t,1),0===i.length&&(s(),s=null)}}}}function G(e,n,r){const l=!Array.isArray(e),c=l?[e]:e,a=n.length<2;return function(t,e){return{subscribe:F(t,e).subscribe}}(r,e=>{let r=!1;const u=[];let f=0,d=t;const p=()=>{if(f)return;d();const s=n(l?u[0]:u,e);a?e(s):d=i(s)?s:t},m=c.map((t,e)=>o(t,t=>{u[e]=t,f&=~(1<<e),r&&p()},()=>{f|=1<<e}));return r=!0,p(),function(){s(m),d()}})}const K="cyclic-timer-config",Q=F(function(){let t=null;try{t=JSON.parse(localStorage.getItem(K))}catch(t){console.error(t)}return t||[]}()),U=F(null);let X=F(null);const Y=G(X,t=>!!t),Z=G(U,t=>null!=t);let tt=null;const et=G([Q,U],([t,e],n)=>{if(tt=n,!t.length)return n(null);const s=e%t.length,i=null!=e&&t[s];if(!i)return n(null);n({...i,timeLeft:i.time,index:s})}),nt=G([Q,U],([t,e])=>null!=e&&t.length?Math.floor(e/t.length)+1:0),st={subscribe:Q.subscribe,set:t=>{ot(),Q.set(t),function(t){localStorage.setItem(K,JSON.stringify(t))}(t)},update:t=>st.set(t(l(Q)))},it=()=>{const t=l(X);t&&(clearInterval(t),X.set(null))},rt=()=>{let t=l(et);if(!t)return it();t.timeLeft--<=0?U.update(t=>++t):tt(t)},ot=()=>{lt(),U.set(null)},lt=()=>{it()};const ct=t=>{if(t<0)return":";let e=Math.floor(t/60),n=t%60;return`${e<10?"0"+e:e}:${n<10?"0"+n:n}`},at=t=>{const[e,n]=t.split(":"),s=60*parseInt(e)+parseInt(n);return isNaN(s)?0:s},ut=t=>((t,e=null)=>{let n=e,s=t.string(e);return{get value(){return n},set value(e){n=e,s=t.string(e)},get value$(){return s},set value$(e){n=t.value(e),s=e}}})({string:ct,value:at},t);let ft,dt=F(!1);const pt={subscribe:dt.subscribe},mt="wakeLock"in navigator,ht=async()=>{if(!mt)return function(){if(ft)return;const t=(t,e,n)=>{var s=document.createElement("source");s.src=e,s.type=n,t.appendChild(s)};ft=document.createElement("video"),ft.muted=!0,ft.loop=!0,ft.playsinline=!0,t(ft,"video/blank.m4v"),t(ft,"video/blank.ogv","video/ogg"),t(ft,"video/blank.webm","video/webm"),ft.style.visibility="hidden",document.body.append(ft)}(),ft?.play(),void dt.set(!0);try{if(ft&&!ft.released)return;ft=await navigator.wakeLock.request("screen"),dt.set(!0),ft.addEventListener("release",()=>{console.log("Screen Wake Lock was released"),dt.set(!1)}),console.log("Screen Wake Lock is active")}catch(t){console.error(`${t.name}, ${t.message}`)}},gt=async()=>{if(!mt&&video)return ft.pause(),void dt.set(!1);ft&&(await ft.release(),dt.set(!1))};const vt=t=>(t.addEventListener("keydown",$t),t.addEventListener("beforeinput",wt),t.addEventListener("input",kt),{destroy:()=>{t.removeEventListener("keydown",$t),t.addEventListener("beforeinput",wt),t.addEventListener("input",kt)}}),bt=/^\d{2}:\d{2}$/,yt=Symbol("prevValue");function $t(t){"ArrowLeft"===t.key&&3===this.selectionStart&&(this.selectionStart=this.selectionEnd=2),"ArrowRight"===t.key&&1===this.selectionStart&&(this.selectionStart=this.selectionEnd=2)}function wt(t){let e=this[yt]=this.value;if("insertText"===t.inputType)e=e.slice(0,this.selectionStart)+t.data+e.slice(this.selectionStart+1),bt.test(e)?this.selectionEnd=this.selectionStart+1:t.preventDefault();else if("deleteContentBackward"===t.inputType){let t=this.selectionStart;if(2===t)return;this.value=e.slice(0,t)+"0"+e.slice(t+1)}}function kt(t){let e=this.value;bt.test(e)||(this.value=this[yt]),2===this.selectionStart&&(this.selectionStart=this.selectionEnd=3)}function xt(e){let n,s;return{c(){n=p("div"),s=m(e[0]),v(n,"class","svelte-h9hghp")},m(t,e){f(t,n,e),u(n,s)},p(t,[e]){1&e&&b(s,t[0])},i:t,o:t,d(t){t&&d(n)}}}function St(t,e,n){let s,{time:i=0}=e;return t.$$set=t=>{"time"in t&&n(1,i=t.time)},t.$$.update=()=>{2&t.$$.dirty&&n(0,s=ct(i))},[s,i]}class Lt extends D{constructor(t){super(),R(this,t,St,xt,r,{time:1})}}function Et(t,e,n){const s=t.slice();return s[20]=e[n],s[21]=e,s[22]=n,s}function _t(t){let e,n;return{c(){e=p("img"),e.src!==(n="images/play.svg")&&v(e,"src","images/play.svg"),v(e,"alt","play"),v(e,"class","svelte-19b52f6")},m(t,n){f(t,e,n)},d(t){t&&d(e)}}}function At(t){let e,n;return{c(){e=p("img"),e.src!==(n="images/pause.svg")&&v(e,"src","images/pause.svg"),v(e,"alt","pause"),v(e,"class","svelte-19b52f6")},m(t,n){f(t,e,n)},d(t){t&&d(e)}}}function Mt(e,n){let r,o,l,c,a,m,b,$;function w(){n[14].call(o,n[21],n[22])}function k(){n[15].call(c,n[21],n[22])}function x(){return n[16](n[22])}return{key:e,first:null,c(){r=p("div"),o=p("input"),l=h(),c=p("input"),a=h(),m=p("button"),m.innerHTML='<img src="images/remove.svg" alt="remove" class="svelte-19b52f6"/>',o.readOnly=n[4],v(o,"class","time svelte-19b52f6"),c.readOnly=n[4],v(c,"class","name svelte-19b52f6"),v(m,"class","svelte-19b52f6"),v(r,"class","input-row svelte-19b52f6"),S(r,"active",n[22]===n[2]),this.first=r},m(e,s){var d;f(e,r,s),u(r,o),y(o,n[20].time.value$),u(r,l),u(r,c),y(c,n[20].name),u(r,a),u(r,m),b||($=[g(o,"input",w),(d=vt.call(null,o),d&&i(d.destroy)?d.destroy:t),g(c,"input",k),g(m,"click",x)],b=!0)},p(t,e){n=t,16&e&&(o.readOnly=n[4]),8&e&&o.value!==n[20].time.value$&&y(o,n[20].time.value$),16&e&&(c.readOnly=n[4]),8&e&&c.value!==n[20].name&&y(c,n[20].name),12&e&&S(r,"active",n[22]===n[2])},d(t){t&&d(r),b=!1,s($)}}}function Ot(t){let e,n,i,r,o,l,c,a,y,w,k,L,E,_,A,M,O,T,N,C,W,j,P=[],R=new Map;function D(t,e){return t[5]?At:_t}let V=D(t),F=V(t);L=new Lt({props:{time:t[1]}});let G=t[3];const K=t=>t[20];for(let e=0;e<G.length;e+=1){let n=Et(t,G,e),s=K(n);R.set(s,P[e]=Mt(s,n))}return{c(){var s;e=p("main"),n=p("div"),i=p("div"),r=p("button"),F.c(),o=h(),l=p("button"),l.innerHTML='<img src="images/stop.svg" alt="stop" class="svelte-19b52f6"/>',c=h(),a=p("div"),y=m("Round: "),w=m(t[7]),k=h(),(s=L.$$.fragment)&&s.c(),E=h();for(let t=0;t<P.length;t+=1)P[t].c();_=h(),A=p("div"),M=p("button"),M.innerHTML='<img src="images/add.svg" alt="add" class="svelte-19b52f6"/>',O=h(),T=p("span"),T.textContent="⏰",v(r,"class","svelte-19b52f6"),v(l,"class","svelte-19b52f6"),v(i,"class","buttons"),v(a,"class","round svelte-19b52f6"),v(M,"class","svelte-19b52f6"),v(A,"class","add svelte-19b52f6"),$(n,"transform","scale("+t[6]+")"),v(n,"class","svelte-19b52f6"),S(n,"running",t[5]),S(n,"started",t[4]),v(T,"class","wakelock svelte-19b52f6"),S(T,"wakelock-on",t[8]),v(e,"class","svelte-19b52f6"),I(()=>t[17].call(e))},m(s,m){f(s,e,m),u(e,n),u(n,i),u(i,r),F.m(r,null),u(i,o),u(i,l),u(n,c),u(n,a),u(a,y),u(a,w),u(n,k),B(L,n,null),u(n,E);for(let t=0;t<P.length;t+=1)P[t].m(n,null);u(n,_),u(n,A),u(A,M),u(e,O),u(e,T),N=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=p("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const s=x();let i;return s?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=g(window,"message",t=>{t.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{i=g(n.contentWindow,"resize",e)}),u(t,n),()=>{(s||i&&n.contentWindow)&&i(),d(n)}}(e,t[17].bind(e)),C=!0,W||(j=[g(r,"click",t[9]),g(l,"click",t[10]),g(M,"click",t[12])],W=!0)},p(t,[e]){V!==(V=D(t))&&(F.d(1),F=V(t),F&&(F.c(),F.m(r,null))),(!C||128&e)&&b(w,t[7]);const s={};2&e&&(s.time=t[1]),L.$set(s),2076&e&&(G=t[3],P=function(t,e,n,s,i,r,o,l,c,a,u,f){let d=t.length,p=r.length,m=d;const h={};for(;m--;)h[t[m].key]=m;const g=[],v=new Map,b=new Map;for(m=p;m--;){const t=f(i,r,m),l=n(t);let c=o.get(l);c?s&&c.p(t,e):(c=a(l,t),c.c()),v.set(l,g[m]=c),l in h&&b.set(l,Math.abs(m-h[l]))}const y=new Set,$=new Set;function w(t){H(t,1),t.m(l,u),o.set(t.key,t),u=t.first,p--}for(;d&&p;){const e=g[p-1],n=t[d-1],s=e.key,i=n.key;e===n?(u=e.first,d--,p--):v.has(i)?!o.has(s)||y.has(s)?w(e):$.has(i)?d--:b.get(s)>b.get(i)?($.add(s),w(e)):(y.add(i),d--):(c(n,o),d--)}for(;d--;){const e=t[d];v.has(e.key)||c(e,o)}for(;p;)w(g[p-1]);return g}(P,e,K,1,t,G,R,n,q,Mt,_,Et)),(!C||64&e)&&$(n,"transform","scale("+t[6]+")"),32&e&&S(n,"running",t[5]),16&e&&S(n,"started",t[4]),256&e&&S(T,"wakelock-on",t[8])},i(t){C||(H(L.$$.fragment,t),C=!0)},o(t){!function(t,e,n,s){if(t&&t.o){if(z.has(t))return;z.add(t),(void 0).c.push(()=>{z.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}}(L.$$.fragment,t),C=!1},d(t){t&&d(e),F.d(),J(L);for(let t=0;t<P.length;t+=1)P[t].d();N(),W=!1,s(j)}}}function Tt(t,e,n){let s,i,r,o,u,f,d,p,m;c(t,st,t=>n(18,o=t)),c(t,et,t=>n(13,u=t)),c(t,Z,t=>n(4,f=t)),c(t,Y,t=>n(5,d=t)),c(t,nt,t=>n(7,p=t)),c(t,pt,t=>n(8,m=t)),o&&o.length||a(st,o=[{name:"action",time:60},{name:"break",time:15}],o);const h=()=>o.map(t=>({name:t.name,time:ut(t.time)}));let g=h();const v=t=>{n(3,g=g.filter((e,n)=>t!==n))};let b=250;return t.$$.update=()=>{8192&t.$$.dirty&&n(1,s=u?u.timeLeft:-1),8192&t.$$.dirty&&n(2,i=u&&u.index),2&t.$$.dirty&&(s<4&&s>0?new Audio("sound/beep-ping.mp3").play():0===s&&new Audio("sound/horn-honk.mp3").play()),4&t.$$.dirty&&null!=i&&new Audio("sound/electronic-chime.mp3").play(),1&t.$$.dirty&&n(6,r=b/250)},[b,s,i,g,f,d,r,p,m,async()=>{if(f&&d)return await gt(),lt();f||(a(st,o=g.map(t=>({name:t.name,time:t.time.value})),o),n(3,g=h())),await ht(),((t=!0)=>{l(Y)||(t&&(U.set(null),U.set(0)),X.set(setInterval(rt,1e3)))})(!f)},async()=>{gt(),ot()},v,()=>{n(3,g=[...g,{name:"new",time:ut(10)}])},u,function(t,e){t[e].time.value$=this.value,n(3,g)},function(t,e){t[e].name=this.value,n(3,g)},t=>v(t),function(){b=this.offsetWidth,n(0,b)}]}return new class extends D{constructor(t){super(),R(this,t,Tt,Ot,r,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
