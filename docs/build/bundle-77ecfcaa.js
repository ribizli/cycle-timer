var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function r(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}function l(t){let e;return i(t,t=>e=t)(),e}function c(t,e,n){t.$$.on_destroy.push(i(e,n))}function a(t,e,n=e){return t.set(n),e}function u(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function p(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function h(){return m(" ")}function g(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function b(t,e,n,s){t.style.setProperty(e,n,s?"important":"")}let k,w;function x(){if(void 0===k){k=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){k=!0}}return k}function S(t,e,n){t.classList[n?"add":"remove"](e)}function L(t){w=t}const E=[],j=[],_=[],A=[],M=Promise.resolve();let O=!1;function I(t){_.push(t)}let T=!1;const N=new Set;function W(){if(!T){T=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];L(e),C(e.$$)}for(L(null),E.length=0;j.length;)j.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];N.has(e)||(N.add(e),e())}_.length=0}while(E.length);for(;A.length;)A.pop()();O=!1,T=!1,N.clear()}}function C(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const z=new Set;function H(t,e){t&&t.i&&(z.delete(t),t.i(e))}function q(t,e){t.d(1),e.delete(t.key)}function B(t,n,o){const{fragment:i,on_mount:l,on_destroy:c,after_update:a}=t.$$;i&&i.m(n,o),I(()=>{const n=l.map(e).filter(r);c?c.push(...n):s(n),t.$$.on_mount=[]}),a.forEach(I)}function J(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function P(t,e){-1===t.$$.dirty[0]&&(E.push(t),O||(O=!0,M.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function R(e,r,o,i,l,c,a=[-1]){const u=w;L(e);const d=r.props||{},p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let m=!1;if(p.ctx=o?o(e,d,(t,n,...s)=>{const r=s.length?s[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),m&&P(e,t)),n}):[],p.update(),m=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);p.fragment&&p.fragment.l(t),t.forEach(f)}else p.fragment&&p.fragment.c();r.intro&&H(e.$$.fragment),B(e,r.target,r.anchor),W()}L(u)}class D{$destroy(){J(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const V=[];function F(e,n=t){let s;const r=[];function i(t){if(o(e,t)&&(e=t,s)){const t=!V.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(o,l=t){const c=[o,l];return r.push(c),1===r.length&&(s=n(i)||t),o(e),()=>{const t=r.indexOf(c);-1!==t&&r.splice(t,1),0===r.length&&(s(),s=null)}}}}function G(e,n,o){const l=!Array.isArray(e),c=l?[e]:e,a=n.length<2;return function(t,e){return{subscribe:F(t,e).subscribe}}(o,e=>{let o=!1;const u=[];let d=0,f=t;const p=()=>{if(d)return;f();const s=n(l?u[0]:u,e);a?e(s):f=r(s)?s:t},m=c.map((t,e)=>i(t,t=>{u[e]=t,d&=~(1<<e),o&&p()},()=>{d|=1<<e}));return o=!0,p(),function(){s(m),f()}})}const K="cyclic-timer-config",Q=F(function(){let t=null;try{t=JSON.parse(localStorage.getItem(K))}catch(t){console.error(t)}return t||[]}()),U=F(null);let X=F(null);const Y=G(X,t=>!!t),Z=G(U,t=>null!=t);let tt=null;const et=G([Q,U],([t,e],n)=>{if(tt=n,!t.length)return n(null);const s=e%t.length,r=null!=e&&t[s];if(!r)return n(null);n({...r,timeLeft:r.time,index:s})}),nt=G([Q,U],([t,e])=>null!=e&&t.length?Math.floor(e/t.length)+1:0),st={subscribe:Q.subscribe,set:t=>{it(),Q.set(t),function(t){localStorage.setItem(K,JSON.stringify(t))}(t)},update:t=>st.set(t(l(Q)))},rt=()=>{const t=l(X);t&&(clearInterval(t),X.set(null))},ot=()=>{let t=l(et);if(!t)return rt();t.timeLeft--<=0?U.update(t=>++t):tt(t)},it=()=>{lt(),U.set(null)},lt=()=>{rt()};const ct=t=>{if(t<0)return":";let e=Math.floor(t/60),n=t%60;return`${e<10?"0"+e:e}:${n<10?"0"+n:n}`},at=t=>{const[e,n]=t.split(":"),s=60*parseInt(e)+parseInt(n);return isNaN(s)?0:s},ut=t=>((t,e=null)=>{let n=e,s=t.string(e);return{get value(){return n},set value(e){n=e,s=t.string(e)},get value$(){return s},set value$(e){n=t.value(e),s=e}}})({string:ct,value:at},t);let dt,ft=null;const pt="wakeLock"in navigator,mt=async()=>{if(!pt)return function(){if(dt)return;const t=(t,e,n)=>{var s=document.createElement("source");s.src=e,s.type=n,t.appendChild(s)};dt=document.createElement("video"),dt.muted=!0,dt.loop=!0,dt.playsinline=!0,t(dt,"video/blank.m4v"),t(dt,"video/blank.ogv","video/ogg"),t(dt,"video/blank.webm","video/webm"),dt.style.visibility="hidden",document.body.append(dt)}(),void dt.play();try{ft&&await ft.release(),ft=await navigator.wakeLock.request("screen"),ft.addEventListener("release",()=>{console.log("Screen Wake Lock was released")}),console.log("Screen Wake Lock is active")}catch(t){console.error(`${t.name}, ${t.message}`)}},ht=async()=>{pt||!dt?ft&&(await ft.release(),ft=null):dt.pause()};const gt=t=>(t.addEventListener("keydown",$t),t.addEventListener("beforeinput",bt),t.addEventListener("input",kt),{destroy:()=>{t.removeEventListener("keydown",$t),t.addEventListener("beforeinput",bt),t.addEventListener("input",kt)}}),vt=/^\d{2}:\d{2}$/,yt=Symbol("prevValue");function $t(t){"ArrowLeft"===t.key&&3===this.selectionStart&&(this.selectionStart=this.selectionEnd=2),"ArrowRight"===t.key&&1===this.selectionStart&&(this.selectionStart=this.selectionEnd=2)}function bt(t){let e=this[yt]=this.value;if("insertText"===t.inputType)e=e.slice(0,this.selectionStart)+t.data+e.slice(this.selectionStart+1),vt.test(e)?this.selectionEnd=this.selectionStart+1:t.preventDefault();else if("deleteContentBackward"===t.inputType){let t=this.selectionStart;if(2===t)return;this.value=e.slice(0,t)+"0"+e.slice(t+1)}}function kt(t){let e=this.value;vt.test(e)||(this.value=this[yt]),2===this.selectionStart&&(this.selectionStart=this.selectionEnd=3)}function wt(e){let n,s;return{c(){n=p("div"),s=m(e[0]),v(n,"class","svelte-h9hghp")},m(t,e){d(t,n,e),u(n,s)},p(t,[e]){1&e&&y(s,t[0])},i:t,o:t,d(t){t&&f(n)}}}function xt(t,e,n){let s,{time:r=0}=e;return t.$$set=t=>{"time"in t&&n(1,r=t.time)},t.$$.update=()=>{2&t.$$.dirty&&n(0,s=ct(r))},[s,r]}class St extends D{constructor(t){super(),R(this,t,xt,wt,o,{time:1})}}function Lt(t,e,n){const s=t.slice();return s[19]=e[n],s[20]=e,s[21]=n,s}function Et(t){let e,n;return{c(){e=p("img"),e.src!==(n="images/play.svg")&&v(e,"src","images/play.svg"),v(e,"alt","play"),v(e,"class","svelte-kojrp3")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function jt(t){let e,n;return{c(){e=p("img"),e.src!==(n="images/pause.svg")&&v(e,"src","images/pause.svg"),v(e,"alt","pause"),v(e,"class","svelte-kojrp3")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function _t(e,n){let o,i,l,c,a,m,y,b,k;function w(){n[12].call(i,n[20],n[21])}function x(){n[13].call(a,n[20],n[21])}function L(...t){return n[14](n[21],...t)}return{key:e,first:null,c(){o=p("div"),i=p("input"),c=h(),a=p("input"),m=h(),y=p("button"),y.innerHTML='<img src="images/remove.svg" alt="remove" class="svelte-kojrp3"/>',i.readOnly=n[4],v(i,"class","time svelte-kojrp3"),a.readOnly=n[4],v(a,"class","name svelte-kojrp3"),v(y,"class","svelte-kojrp3"),v(o,"class","input-row svelte-kojrp3"),S(o,"active",n[21]===n[3]),this.first=o},m(e,s){var f;d(e,o,s),u(o,i),$(i,n[19].time.value$),u(o,c),u(o,a),$(a,n[19].name),u(o,m),u(o,y),b||(k=[g(i,"input",w),(f=l=gt.call(null,i),f&&r(f.destroy)?f.destroy:t),g(a,"input",x),g(y,"click",L)],b=!0)},p(t,e){n=t,16&e&&(i.readOnly=n[4]),1&e&&i.value!==n[19].time.value$&&$(i,n[19].time.value$),16&e&&(a.readOnly=n[4]),1&e&&a.value!==n[19].name&&$(a,n[19].name),9&e&&S(o,"active",n[21]===n[3])},d(t){t&&f(o),b=!1,s(k)}}}function At(t){let e,n,r,o,i,l,c,a,$,k,w,L,E,j,_,A,M,O,T,N,W=[],C=new Map;function P(t,e){return t[5]?jt:Et}let R=P(t),D=R(t);L=new St({props:{time:t[2]}});let V=t[0];const F=t=>t[19];for(let e=0;e<V.length;e+=1){let n=Lt(t,V,e),s=F(n);C.set(s,W[e]=_t(s,n))}return{c(){var s;e=p("main"),n=p("div"),r=p("div"),o=p("button"),D.c(),i=h(),l=p("button"),l.innerHTML='<img src="images/stop.svg" alt="stop" class="svelte-kojrp3"/>',c=h(),a=p("div"),$=m("Round: "),k=m(t[7]),w=h(),(s=L.$$.fragment)&&s.c(),E=h();for(let t=0;t<W.length;t+=1)W[t].c();j=h(),_=p("div"),A=p("button"),A.innerHTML='<img src="images/add.svg" alt="add" class="svelte-kojrp3"/>',v(o,"class","svelte-kojrp3"),v(l,"class","svelte-kojrp3"),v(r,"class","buttons"),v(a,"class","round svelte-kojrp3"),v(A,"class","svelte-kojrp3"),v(_,"class","add svelte-kojrp3"),b(n,"transform","scale("+t[6]+")"),v(n,"class","svelte-kojrp3"),S(n,"running",t[5]),S(n,"started",t[4]),v(e,"class","svelte-kojrp3"),I(()=>t[15].call(e))},m(s,m){d(s,e,m),u(e,n),u(n,r),u(r,o),D.m(o,null),u(r,i),u(r,l),u(n,c),u(n,a),u(a,$),u(a,k),u(n,w),B(L,n,null),u(n,E);for(let t=0;t<W.length;t+=1)W[t].m(n,null);u(n,j),u(n,_),u(_,A),M=function(t,e){const n=getComputedStyle(t),s=(parseInt(n.zIndex)||0)-1;"static"===n.position&&(t.style.position="relative");const r=p("iframe");r.setAttribute("style",`display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${s};`),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const o=x();let i;return o?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=g(window,"message",t=>{t.source===r.contentWindow&&e()})):(r.src="about:blank",r.onload=()=>{i=g(r.contentWindow,"resize",e)}),u(t,r),()=>{(o||i&&r.contentWindow)&&i(),f(r)}}(e,t[15].bind(e)),O=!0,T||(N=[g(o,"click",t[8]),g(l,"click",t[9]),g(A,"click",t[11])],T=!0)},p(t,[e]){R!==(R=P(t))&&(D.d(1),D=R(t),D&&(D.c(),D.m(o,null))),(!O||128&e)&&y(k,t[7]);const s={};if(4&e&&(s.time=t[2]),L.$set(s),1049&e){const s=t[0];W=function(t,e,n,s,r,o,i,l,c,a,u,d){let f=t.length,p=o.length,m=f;const h={};for(;m--;)h[t[m].key]=m;const g=[],v=new Map,y=new Map;for(m=p;m--;){const t=d(r,o,m),l=n(t);let c=i.get(l);c?s&&c.p(t,e):(c=a(l,t),c.c()),v.set(l,g[m]=c),l in h&&y.set(l,Math.abs(m-h[l]))}const $=new Set,b=new Set;function k(t){H(t,1),t.m(l,u),i.set(t.key,t),u=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],s=e.key,r=n.key;e===n?(u=e.first,f--,p--):v.has(r)?!i.has(s)||$.has(s)?k(e):b.has(r)?f--:y.get(s)>y.get(r)?(b.add(s),k(e)):($.add(r),f--):(c(n,i),f--)}for(;f--;){const e=t[f];v.has(e.key)||c(e,i)}for(;p;)k(g[p-1]);return g}(W,e,F,1,t,s,C,n,q,_t,j,Lt)}(!O||64&e)&&b(n,"transform","scale("+t[6]+")"),32&e&&S(n,"running",t[5]),16&e&&S(n,"started",t[4])},i(t){O||(H(L.$$.fragment,t),O=!0)},o(t){!function(t,e,n,s){if(t&&t.o){if(z.has(t))return;z.add(t),(void 0).c.push(()=>{z.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}}(L.$$.fragment,t),O=!1},d(t){t&&f(e),D.d(),J(L);for(let t=0;t<W.length;t+=1)W[t].d();M(),T=!1,s(N)}}}function Mt(t,e,n){let s,r,o,i,u;c(t,st,t=>n(16,s=t)),c(t,et,t=>n(17,r=t)),c(t,Z,t=>n(4,o=t)),c(t,Y,t=>n(5,i=t)),c(t,nt,t=>n(7,u=t)),s&&s.length||a(st,s=[{name:"action",time:60},{name:"break",time:15}]);const d=()=>s.map(t=>({name:t.name,time:ut(t.time)}));let f=d();const p=t=>{n(0,f=f.filter((e,n)=>t!==n))};let m=250;let h,g,v;return t.$$.update=()=>{131072&t.$$.dirty&&n(2,h=r?r.timeLeft:-1),131072&t.$$.dirty&&n(3,g=r&&r.index),4&t.$$.dirty&&(h<4&&h>0?new Audio("sound/beep-ping.mp3").play():0===h&&new Audio("sound/horn-honk.mp3").play()),8&t.$$.dirty&&null!=g&&new Audio("sound/electronic-chime.mp3").play(),2&t.$$.dirty&&n(6,v=m/250)},[f,m,h,g,o,i,v,u,async()=>{if(o&&i)return await ht(),lt();o||(a(st,s=f.map(t=>({name:t.name,time:t.time.value}))),n(0,f=d())),await mt(),((t=!0)=>{l(Y)||(t&&(U.set(null),U.set(0)),X.set(setInterval(ot,1e3)))})(!o)},async()=>{ht(),it()},p,()=>{n(0,f=[...f,{name:"new",time:ut(10)}])},function(t,e){t[e].time.value$=this.value,n(0,f)},function(t,e){t[e].name=this.value,n(0,f)},t=>p(t),function(){m=this.offsetWidth,n(1,m)}]}return new class extends D{constructor(t){super(),R(this,t,Mt,At,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle-77ecfcaa.js.map
